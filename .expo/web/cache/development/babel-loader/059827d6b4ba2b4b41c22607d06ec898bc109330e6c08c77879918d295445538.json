{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport jwt from \"jsonwebtoken\";\nfunction checkPermission(req, res, next) {\n  var tokenHeader = req.header(\"Authorization\");\n  if (tokenHeader === undefined) {\n    return res.json({\n      status: 403,\n      message: \"Acesso negado.\"\n    });\n  }\n  var _tokenHeader$split = tokenHeader.split(\" \"),\n    _tokenHeader$split2 = _slicedToArray(_tokenHeader$split, 2),\n    prefix = _tokenHeader$split2[0],\n    token = _tokenHeader$split2[1];\n  var permission = jwt.decode(token);\n  if ((permission == null ? void 0 : permission.type) === \"Member\") {\n    res.json({\n      status: 403,\n      message: \"Acesso negado.\"\n    });\n  }\n  next();\n}\nexport default checkPermission;","map":{"version":3,"names":["jwt","checkPermission","req","res","next","tokenHeader","header","undefined","json","status","message","_tokenHeader$split","split","_tokenHeader$split2","_slicedToArray","prefix","token","permission","decode","type"],"sources":["C:/Users/digoR/OneDrive/√Årea de Trabalho/DEV/Sollos/Deploy/VistoApp_Backend/src/middleware/permissionMiddleware.ts"],"sourcesContent":["import { Request, Response, NextFunction } from \"express\";\r\nimport jwt, { JwtPayload } from \"jsonwebtoken\";\r\n\r\nfunction checkPermission(req: Request, res: Response, next: NextFunction) {\r\n  const tokenHeader = req.header(\"Authorization\");\r\n\r\n  if (tokenHeader === undefined) {\r\n    return res.json({ status: 403, message: \"Acesso negado.\" });\r\n  }\r\n\r\n  const [prefix, token] = tokenHeader.split(\" \");\r\n\r\n  const permission = jwt.decode(token) as JwtPayload;\r\n\r\n  if (permission?.type === \"Member\") {\r\n    res.json({ status: 403, message: \"Acesso negado.\" });\r\n  }\r\n\r\n  next();\r\n}\r\n\r\nexport default checkPermission;\r\n"],"mappings":";AACA,OAAOA,GAAG,MAAsB,cAAc;AAE9C,SAASC,eAAeA,CAACC,GAAY,EAAEC,GAAa,EAAEC,IAAkB,EAAE;EACxE,IAAMC,WAAW,GAAGH,GAAG,CAACI,MAAM,CAAC,eAAe,CAAC;EAE/C,IAAID,WAAW,KAAKE,SAAS,EAAE;IAC7B,OAAOJ,GAAG,CAACK,IAAI,CAAC;MAAEC,MAAM,EAAE,GAAG;MAAEC,OAAO,EAAE;IAAiB,CAAC,CAAC;EAC7D;EAEA,IAAAC,kBAAA,GAAwBN,WAAW,CAACO,KAAK,CAAC,GAAG,CAAC;IAAAC,mBAAA,GAAAC,cAAA,CAAAH,kBAAA;IAAvCI,MAAM,GAAAF,mBAAA;IAAEG,KAAK,GAAAH,mBAAA;EAEpB,IAAMI,UAAU,GAAGjB,GAAG,CAACkB,MAAM,CAACF,KAAK,CAAe;EAElD,IAAI,CAAAC,UAAU,oBAAVA,UAAU,CAAEE,IAAI,MAAK,QAAQ,EAAE;IACjChB,GAAG,CAACK,IAAI,CAAC;MAAEC,MAAM,EAAE,GAAG;MAAEC,OAAO,EAAE;IAAiB,CAAC,CAAC;EACtD;EAEAN,IAAI,CAAC,CAAC;AACR;AAEA,eAAeH,eAAe"},"metadata":{},"sourceType":"module","externalDependencies":[]}